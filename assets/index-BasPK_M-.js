import{r as a,j as e,N as te,A as ae,m as z,u as _,F as B,a as K,L as E,b as R,c as U,d as re,e as le,f as ne,g as G,h as I,i as Q,k as H,l as W,n as M,C as oe,o as ie,p as de,q as ce,s as me,t as J,v as Y,w as xe,x as ue,y as he,z as ge,B as pe,D as be,E as je,G as fe,H as ye,S as Ne,I as ve,J as we,R as Se,K as A,M as Ce,O as ke}from"./vendor-BK1rPgiB.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))d(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&d(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();const X=a.createContext(),L=()=>a.useContext(X),Z=({children:t})=>{const[c,s]=a.useState(localStorage.getItem("token")||null),[d,i]=a.useState(localStorage.getItem("role")||null),[n,r]=a.useState(localStorage.getItem("name")||null);a.useEffect(()=>{c?(localStorage.setItem("token",c),localStorage.setItem("role",d),localStorage.setItem("name",n)):(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name"))},[c,d,n]);const h=()=>{s(null),i(null),r(null),localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name")};return e.jsx(X.Provider,{value:{token:c,setToken:s,role:d,setRole:i,name:n,setName:r,logout:h},children:t})},F=({children:t})=>{const{token:c}=L();return c?t:e.jsx(te,{to:"/login",replace:!0})},O=({onConfirm:t,children:c,message:s,additionalInfo:d,confirmText:i="Yes, Confirm",cancelText:n="Cancel",icon:r,buttonTextColor:h="text-white",buttonBackgroundColor:N="bg-red-600"})=>{const[g,j]=a.useState(!1),u=m=>{m.preventDefault(),j(!0)},f=()=>{j(!1),t()},v=()=>{j(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(ae,{children:g&&e.jsx(z.div,{className:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(z.div,{className:"bg-white p-8 rounded-2xl shadow-2xl space-y-6 w-96 max-w-md flex flex-col items-center justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[r&&e.jsx("div",{className:"text-4xl text-red-600",children:r}),e.jsx("p",{className:"text-xl font-semibold text-gray-800",children:s})]}),d&&e.jsx("div",{className:"text-sm text-gray-500 text-center",children:d}),e.jsxs("div",{className:"flex justify-center space-x-6 mt-6 w-full",children:[e.jsx("button",{onClick:v,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-md text-sm font-medium hover:bg-gray-400 transition duration-200",children:n}),e.jsx("button",{onClick:f,className:`${N} ${h} px-6 py-2 rounded-md text-sm font-medium hover:bg-opacity-90 transition duration-200`,children:i})]})]})})}),e.jsx("div",{onClick:u,children:c})]})},T=[{path:"/admin-dashboard",icon:e.jsx(U,{}),label:"Dashboard"},{path:"/order-management-admin",icon:e.jsx(re,{}),label:"Orders Management"},{path:"/drugs",icon:e.jsx(le,{}),label:"Drugs"}],q=()=>{const[t,c]=a.useState(!0),{logout:s}=L(),d=_(),i=()=>{c(r=>!r)},n=()=>{s(),d("/")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-gray-900 text-white transition-all duration-300 ${t?"w-64":"w-16"} fixed md:relative top-0 left-0 h-full z-50 flex flex-col hidden md:flex`,children:[e.jsx("button",{className:"text-white p-4 focus:outline-none hover:bg-gray-700 transition md:flex items-center justify-center",onClick:i,children:t?e.jsx(B,{size:24}):e.jsx(K,{size:24})}),e.jsx("ul",{className:"mt-4 space-y-2 flex-grow",children:T.map(r=>e.jsx("li",{children:e.jsxs(E,{to:r.path,className:"flex items-center p-2 hover:bg-gray-700 transition rounded-lg",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:r.icon}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:r.label})]})},r.path))}),e.jsx(O,{onConfirm:n,message:"Are you sure you want to logout?",children:e.jsxs("button",{className:"flex items-center p-2 mt-auto hover:bg-red-600 transition rounded-lg text-white w-full text-left",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:e.jsx(R,{})}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"Logout"})]})})]}),e.jsxs("div",{className:"bg-gray-900 text-white fixed bottom-0 left-0 w-full flex justify-around p-2 md:hidden z-50",children:[T.map(r=>e.jsx(E,{to:r.path,className:"flex flex-col items-center",children:e.jsx("span",{className:"text-xl",children:r.icon})},r.path)),e.jsx(O,{onConfirm:n,message:"Are you sure you want to logout?",children:e.jsx("button",{className:"flex flex-col items-center text-red-500",children:e.jsx("span",{className:"text-xl",children:e.jsx(R,{})})})})]})]})},D=ne.create({baseURL:"https://api.rashen.me",headers:{"Content-Type":"application/json"}});D.interceptors.request.use(t=>{const c=localStorage.getItem("token");return c&&(t.headers.Authorization=`Bearer ${c}`),t},t=>Promise.reject(t));D.interceptors.response.use(t=>t,t=>{var c;return((c=t.response)==null?void 0:c.status)===401&&(console.error("Unauthorized! Redirecting to login..."),localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(t)});const De=()=>{const[t,c]=a.useState(null),[s,d]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{const n=await D.get("/api/profile");c(n.data.user)}catch(n){console.error("Failed to fetch admin profile",n)}finally{d(!1)}})()},[]),e.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[e.jsx(q,{className:"w-64 flex-shrink-0"}),e.jsxs("main",{className:"flex-1 p-8 overflow-y-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-blue-800 mb-4",children:"üõ†Ô∏è Admin Dashboard"}),!s&&t&&e.jsxs("p",{className:"text-lg text-gray-700 mb-6",children:["Welcome back, ",e.jsx("span",{className:"font-semibold text-blue-700",children:t.name}),"!"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-blue-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-blue-700 mb-2",children:"üë• Manage Users"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Add, edit, or remove users from the system."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-blue-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-blue-700 mb-2",children:"üìÑ View Prescriptions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Monitor all prescription records and status."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-blue-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-blue-700 mb-2",children:"‚öôÔ∏è System Settings"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage roles, permissions, and platform settings."})]})]})]})]})},Pe=()=>{const t=_(),[c,s]=a.useState([]),[d,i]=a.useState(""),[n,r]=a.useState(""),[h,N]=a.useState(!0),[g,j]=a.useState(null),{name:u}=L();a.useEffect(()=>{(async()=>{var l,x;try{const y=await D.get("/api/admin/prescriptions");s(y.data.prescriptions)}catch(y){j(((x=(l=y.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to fetch orders.")}finally{N(!1)}})()},[]);const f=a.useMemo(()=>c.filter(o=>{const l=n?o.status===n:!0,x=d?Object.values(o).some(y=>String(y).toLowerCase().includes(d.toLowerCase())):!0;return l&&x}),[c,n,d]),v=a.useMemo(()=>[{accessorKey:"id",header:"Order ID",cell:o=>{const l=o.getValue();return e.jsxs("button",{className:"text-teal-600 hover:underline text-sm",onClick:()=>t(`/admin/orders/${l}`),children:["#",l]})}},{accessorKey:"user.name",header:"Customer Name",cell:o=>e.jsx("span",{className:"text-sm",children:o.getValue()||"-"})},{accessorKey:"status",header:"Status",cell:o=>e.jsx("span",{className:"capitalize text-sm font-medium text-gray-700",children:o.getValue()})},{accessorKey:"delivery_address",header:"Address",cell:o=>e.jsx("span",{className:"text-sm",children:o.getValue()||"-"})},{accessorKey:"delivery_time",header:"Delivery Time",cell:o=>e.jsx("span",{className:"text-sm",children:o.getValue()?new Date(o.getValue()).toLocaleString():"-"})},{accessorKey:"created_at",header:"Created At",cell:o=>e.jsx("span",{className:"text-sm",children:new Date(o.getValue()).toLocaleString()})}],[t]),m=G({data:f,columns:v,state:{globalFilter:d},onGlobalFilterChange:i,getCoreRowModel:W(),getFilteredRowModel:H(),getPaginationRowModel:Q()});return e.jsx("div",{className:"flex flex-col items-center min-h-screen bg-gray-50 py-10 px-4",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-xl w-full max-w-6xl p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:()=>t("/order-management"),className:"fixed bottom-6 right-6 bg-gray-800 text-white py-3 px-6 rounded-full shadow-lg hover:bg-gray-900 transition duration-200 z-50",children:"Back to Management"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"All Orders (Admin)"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Admin: ",u]})]}),e.jsx("div",{className:"mb-4 flex flex-wrap gap-2",children:["","pending","quotationed","approved","delivery","delivered"].map(o=>e.jsx("button",{onClick:()=>r(o),className:`px-4 py-1 rounded-full border ${n===o?"bg-blue-600 text-white border-blue-600":"bg-white text-blue-600 border-blue-600 hover:bg-blue-100"} transition`,children:o===""?"All":o.charAt(0).toUpperCase()+o.slice(1)},o||"all"))}),e.jsx("input",{type:"text",placeholder:"Search orders...",value:d??"",onChange:o=>i(o.target.value),className:"mb-6 w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 text-gray-700"}),h?e.jsx("p",{className:"text-center text-gray-600",children:"Loading..."}):g?e.jsx("p",{className:"text-center text-red-600",children:g}):f.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No orders available."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full border",children:[e.jsx("thead",{className:"bg-teal-600 text-white",children:m.getHeaderGroups().map(o=>e.jsx("tr",{children:o.headers.map(l=>e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:I(l.column.columnDef.header,l.getContext())},l.id))},o.id))}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.getRowModel().rows.map(o=>e.jsx("tr",{className:"hover:bg-gray-50",children:o.getVisibleCells().map(l=>e.jsx("td",{className:"px-6 py-4 text-sm",children:I(l.column.columnDef.cell,l.getContext())},l.id))},o.id))})]})}),e.jsxs("div",{className:"flex justify-center items-center mt-6 space-x-4",children:[e.jsx("button",{onClick:()=>m.previousPage(),disabled:!m.getCanPreviousPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",m.getState().pagination.pageIndex+1," of"," ",m.getPageCount()]}),e.jsx("button",{onClick:()=>m.nextPage(),disabled:!m.getCanNextPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Next"})]})]})]})})},Ae=()=>{var g,j,u,f,v;const{id:t}=M(),c=_(),[s,d]=a.useState(null),[i,n]=a.useState(!0),[r,h]=a.useState(null);a.useEffect(()=>{(async()=>{var o,l;try{const x=await D.get(`/api/admin/prescriptions/${t}`);d(x.data)}catch(x){h(((l=(o=x.response)==null?void 0:o.data)==null?void 0:l.message)||"Failed to fetch order.")}finally{n(!1)}})()},[t]);const N=async()=>{if(s.status==="pending"){c(`/admin/prescriptions/${s.id}/quotation`);return}let m=null;if(s.status==="approved")m="delivery";else if(s.status==="delivery")m="delivered";else return;try{await D.put(`/api/admin/prescriptions/${s.id}/status`,{status:m}),d({...s,status:m})}catch{alert("Failed to update status.")}};return i?e.jsx("p",{className:"text-center mt-10",children:"Loading..."}):r?e.jsx("p",{className:"text-center text-red-600 mt-10",children:r}):e.jsxs("div",{className:"max-w-6xl mx-auto p-8 bg-white rounded-2xl shadow-lg mt-10 transition-all duration-300",children:[e.jsxs("h1",{className:"text-3xl font-extrabold mb-8 text-gray-900",children:["Order Summary ",e.jsxs("span",{className:"text-blue-600",children:["#",s.id]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2",children:"Customer Details"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Name:"})," ",(g=s.customer)==null?void 0:g.name]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",(j=s.customer)==null?void 0:j.email]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Address:"})," ",(u=s.customer)==null?void 0:u.address]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Contact:"})," ",(f=s.customer)==null?void 0:f.contact_no]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2",children:"Prescription Info"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:"capitalize text-blue-600",children:s.status})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," ",s.note||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Time:"})," ",s.delivery_time?new Date(s.delivery_time).toLocaleString():"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created At:"})," ",new Date(s.created_at).toLocaleString()]})]})]}),((v=s.images)==null?void 0:v.length)>0&&e.jsxs("div",{className:"mb-10",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2 mb-4",children:"Prescription Images"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:s.images.map(m=>e.jsx("img",{src:`data:image/jpeg;base64,${m.img}`,alt:"Prescription",className:"rounded-xl shadow-md border object-cover h-52 w-full hover:scale-105 transition-transform duration-300"},m.id))})]}),e.jsxs("div",{className:"mb-10 overflow-x-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2 mb-4",children:"Prescription List"}),e.jsxs("table",{className:"w-full text-sm text-left border border-gray-300 rounded-xl overflow-hidden shadow",children:[e.jsx("thead",{className:"bg-blue-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Drug"}),e.jsx("th",{className:"px-4 py-3",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-3",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white",children:s.prescription_list.map((m,o)=>e.jsxs("tr",{className:"border-t hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-2",children:m.drug_name}),e.jsx("td",{className:"px-4 py-2",children:m.quantity}),e.jsxs("td",{className:"px-4 py-2",children:["LKR ",m.unit_price]}),e.jsxs("td",{className:"px-4 py-2 font-medium",children:["LKR ",m.total]})]},o))})]})]}),e.jsxs("div",{className:"text-right text-2xl font-bold text-gray-900 mb-8",children:["Total: ",e.jsxs("span",{className:"text-green-600",children:["LKR ",s.total_price]})]}),["pending","approved","delivery"].includes(s.status)&&e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("button",{onClick:N,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl transition-colors duration-300",children:[s.status==="pending"&&"Create Quotation",s.status==="approved"&&"Mark as Delivery",s.status==="delivery"&&"Mark as Delivered"]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>c(-1),className:"bg-gray-800 hover:bg-gray-900 text-white px-6 py-3 rounded-xl transition-colors duration-300",children:"‚Üê Back"})})]})},_e=({value:t,onChange:c,allDrugs:s})=>{const[d,i]=a.useState(t||""),[n,r]=a.useState([]),[h,N]=a.useState(!1),g=a.useRef();a.useEffect(()=>{if(d.trim()===""){r([]);return}const u=s.filter(f=>f.name.toLowerCase().includes(d.toLowerCase()));r(u)},[d,s]),a.useEffect(()=>{const u=f=>{g.current&&!g.current.contains(f.target)&&N(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]);const j=u=>{i(u.name),c(u.name,Number(u.price),u.id),N(!1)};return e.jsxs("div",{className:"relative",ref:g,children:[e.jsx("input",{type:"text",placeholder:"Type drug name",value:d,onChange:u=>{i(u.target.value),c(u.target.value,0,null),N(!0)},onFocus:()=>N(!0),className:"border px-4 py-2 rounded w-full"}),h&&n.length>0&&e.jsx("ul",{className:"absolute z-10 bg-white border w-full max-h-48 overflow-auto rounded shadow-md mt-1",children:n.map(u=>e.jsxs("li",{className:"px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:()=>j(u),children:[u.name," - $",Number(u.price).toFixed(2)]},u.id))}),h&&n.length===0&&e.jsx("div",{className:"absolute z-10 bg-white border w-full rounded mt-1 px-4 py-2 text-gray-500",children:"No drugs found"})]})},Fe=()=>{var y,p,b,w,S,k;const{id:t}=M(),c=_(),[s,d]=a.useState(null),[i,n]=a.useState([]),[r,h]=a.useState({drug_name:"",quantity:1,unit_price:0,drug_id:null}),[N,g]=a.useState([]),[j,u]=a.useState(0),[f,v]=a.useState(!0),[m,o]=a.useState(null);a.useEffect(()=>{(async()=>{try{const[P,$]=await Promise.all([D.get(`/api/admin/prescriptions/${t}`),D.get("/api/drugs")]);d(P.data),g($.data)}catch{o("Failed to load data.")}finally{v(!1)}})()},[t]);const l=()=>{!r.drug_id||!r.drug_name||(n([...i,{...r}]),h({drug_name:"",quantity:1,unit_price:0,drug_id:null}))},x=async()=>{try{for(const C of i)await D.post("/api/prescriptionlist-items",{prescription_id:t,drug_id:C.drug_id,quantity:C.quantity,unit_price:C.unit_price});await D.put(`/api/admin/prescriptions/${t}/status`,{status:"quotationed"}),c(`/admin/orders/${t}`)}catch(C){console.error(C),alert("Failed to create quotation or update status.")}};return f?e.jsx("p",{className:"text-center mt-10",children:"Loading..."}):m?e.jsx("p",{className:"text-center text-red-600 mt-10",children:m}):e.jsxs("div",{className:"max-w-5xl mx-auto p-8 bg-white mt-10 rounded-xl shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:["Create Quotation for Prescription #",t]}),((y=s==null?void 0:s.images)==null?void 0:y.length)>0&&e.jsxs("div",{className:"mb-8 border-b border-gray-200 pb-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:`data:image/jpeg;base64,${(p=s.images[j])==null?void 0:p.img}`,alt:"Main Prescription",className:"max-h-96 rounded-xl shadow-md border object-contain"})}),e.jsx("div",{className:"flex space-x-4 overflow-x-auto",children:s.images.map((C,P)=>e.jsx("img",{src:`data:image/jpeg;base64,${C.img}`,alt:`Thumbnail ${P+1}`,onClick:()=>u(P),className:`h-24 w-24 object-cover rounded-md border cursor-pointer ${P===j?"ring-2 ring-blue-500 scale-105":"opacity-70 hover:opacity-100"}`},C.id||P))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8 text-sm text-gray-700",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"font-semibold border-b pb-1",children:"Customer Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",((b=s==null?void 0:s.customer)==null?void 0:b.name)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",((w=s==null?void 0:s.customer)==null?void 0:w.email)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((S=s==null?void 0:s.customer)==null?void 0:S.address)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",((k=s==null?void 0:s.customer)==null?void 0:k.contact_no)||"-"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"font-semibold border-b pb-1",children:"Prescription Info"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:"capitalize text-blue-600",children:(s==null?void 0:s.status)||"-"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," ",(s==null?void 0:s.note)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Time:"})," ",s!=null&&s.delivery_time?new Date(s.delivery_time).toLocaleString():"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created At:"})," ",s!=null&&s.created_at?new Date(s.created_at).toLocaleString():"-"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add Drug"}),e.jsx(_e,{value:r.drug_name,allDrugs:N,onChange:(C,P,$)=>{h({...r,drug_name:C,unit_price:P,drug_id:$})}}),e.jsx("input",{type:"number",min:"1",value:r.quantity,onChange:C=>h({...r,quantity:parseInt(C.target.value)||1}),placeholder:"Quantity",className:"border px-4 py-2 rounded w-full mt-2"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:r.unit_price,onChange:C=>h({...r,unit_price:parseFloat(C.target.value)||0}),placeholder:"Unit Price",className:"border px-4 py-2 rounded w-full mt-2"}),e.jsx("button",{onClick:l,className:"bg-green-600 text-white px-4 py-2 rounded mt-4 hover:bg-green-700",children:"+ Add Drug"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Added Drugs"}),i.length===0?e.jsx("p",{className:"text-gray-500",children:"No drugs added yet."}):e.jsx("ul",{className:"space-y-3",children:i.map((C,P)=>e.jsxs("li",{className:"p-4 border rounded bg-gray-50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:C.drug_name}),e.jsxs("p",{className:"text-sm",children:["Qty: ",C.quantity,", Price: $",C.unit_price.toFixed(2)]})]}),e.jsx("button",{onClick:()=>n(i.filter(($,se)=>se!==P)),className:"text-red-500 hover:underline text-sm",children:"Remove"})]},P))})]})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx("button",{onClick:x,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Submit Quotation"}),e.jsx("button",{onClick:()=>c(-1),className:"text-sm text-gray-600 underline hover:text-gray-900",children:"‚Üê Go Back"})]})]})},Le=()=>{const t=_(),{name:c,role:s}=L();return console.log("Admin user:",c,"Role:",s),e.jsxs("div",{className:"flex flex-col md:flex-row h-screen",children:[e.jsx(q,{}),e.jsxs("div",{className:"p-8 w-full overflow-auto",children:[e.jsxs("div",{className:"text-3xl font-semibold mb-8",children:[e.jsx("h1",{children:"Order Management"}),e.jsx("p",{className:"text-lg text-gray-500",children:"Monitor, process, and manage all orders"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(oe,{className:"mr-2 text-blue-600"}),"View All Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Access all order details in one place."}),e.jsx("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 w-full sm:w-auto",onClick:()=>t("/admin-all-orders"),children:"View Orders"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(ie,{className:"mr-2 text-yellow-500"}),"Pending Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Review and take action on pending orders."}),e.jsx("button",{className:"bg-yellow-500 text-white py-2 px-4 rounded-lg hover:bg-yellow-600 w-full sm:w-auto",onClick:()=>t("/admin/orders/pending"),children:"Pending Orders"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(de,{className:"mr-2 text-green-600"}),"Completed Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"View history of all fulfilled orders."}),e.jsx("button",{className:"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 w-full sm:w-auto",onClick:()=>t("/admin/orders/completed"),children:"Completed Orders"})]})]})]})]})},Ee=()=>{const[t,c]=a.useState([]),[s,d]=a.useState(!0),[i,n]=a.useState(null),[r,h]=a.useState({id:null,name:"",price:""}),[N,g]=a.useState(""),[j,u]=a.useState("list"),f="https://api.rashen.me",v=()=>localStorage.getItem("token"),m=async()=>{d(!0),n(null);try{const p=await fetch(`${f}api/drugs`,{headers:{Authorization:`Bearer ${v()}`}});if(!p.ok)throw new Error(`Failed to load drugs (${p.status})`);const w=(await p.json()).map(S=>({...S,price:Number(S.price)}));c(w)}catch(p){n(p.message)}finally{d(!1)}};a.useEffect(()=>{m()},[]);const o=p=>{const{name:b,value:w}=p.target;h(S=>({...S,[b]:w}))},l=async p=>{if(p.preventDefault(),g(""),!r.name.trim()||!r.price){g("Please fill in all fields.");return}try{const b=r.id?"PUT":"POST",w=r.id?`${f}api/drugs/${r.id}`:`${f}/api/drugs`,S=await fetch(w,{method:b,headers:{"Content-Type":"application/json",Authorization:`Bearer ${v()}`},body:JSON.stringify({name:r.name.trim(),price:parseFloat(r.price)})});if(!S.ok){const k=await S.json();throw new Error(k.message||`Failed to save drug (${S.status})`)}h({id:null,name:"",price:""}),m(),u("list")}catch(b){g(b.message)}},x=p=>{h({id:p.id,name:p.name,price:p.price.toString()}),g(""),u("form")},y=async p=>{if(window.confirm("Are you sure you want to delete this drug?"))try{const b=await fetch(`${f}/api/drugs/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${v()}`}});if(!b.ok){const w=await b.json();throw new Error(w.message||`Failed to delete drug (${b.status})`)}m()}catch(b){alert(b.message)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsx("div",{children:e.jsx(q,{className:"w-64 flex-shrink-0"})}),e.jsxs("div",{className:"flex-grow p-8 max-w-7xl mx-auto w-full",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Manage Drugs"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsxs("div",{className:"md:w-1/3 bg-white shadow rounded-lg p-6",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsx("button",{className:"px-4 py-2 rounded bg-teal-600 text-white hover:bg-teal-700",onClick:()=>{h({id:null,name:"",price:""}),g(""),u("form")},children:"Add New Drug"})}),j==="form"&&e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:l,className:"flex flex-col gap-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Drug Name",value:r.name,onChange:o,className:"p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0}),e.jsx("input",{type:"number",name:"price",placeholder:"Price",min:"0",step:"0.01",value:r.price,onChange:o,className:"p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0}),e.jsx("button",{type:"submit",className:"bg-teal-600 text-white px-6 py-2 rounded hover:bg-teal-700 transition",children:r.id?"Update Drug":"Add Drug"})]}),N&&e.jsx("p",{className:"text-red-600 mt-4 text-center font-medium",children:N})]}),j==="list"&&e.jsx("p",{className:"text-center text-gray-500 mt-8",children:'Select "View Drugs List" on the right to see drugs.'})]}),e.jsx("div",{className:"md:w-2/3 bg-white shadow rounded-lg p-6 overflow-auto max-h-[600px]",children:s?e.jsx("p",{className:"text-center text-gray-500",children:"Loading drugs..."}):i?e.jsx("p",{className:"text-center text-red-600",children:i}):t.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No drugs available."}):e.jsxs("table",{className:"w-full border border-gray-300 rounded table-auto",children:[e.jsx("thead",{className:"bg-teal-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Price ($)"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(p=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onDoubleClick:()=>x(p),children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:p.name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:p.price!=null?p.price.toFixed(2):"0.00"}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-center space-x-4",children:[e.jsx("button",{onClick:()=>x(p),className:"text-teal-600 hover:underline",type:"button",children:"Edit"}),e.jsx("button",{onClick:()=>y(p.id),className:"text-red-600 hover:underline",type:"button",children:"Delete"})]})]},p.id))})]})})]})]})]})},Oe=()=>{const t=_();return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-blue-50 p-6",children:[e.jsx("h1",{className:"text-5xl font-extrabold text-blue-900 mb-8 drop-shadow-md",children:"Welcome to Pharmacy"}),e.jsx("p",{className:"text-xl text-blue-700 mb-12 max-w-xl text-center",children:"Order now and get your medicines delivered fast and safely to your doorstep!"}),e.jsxs("div",{className:"space-x-6 flex flex-wrap justify-center",children:[e.jsxs("button",{onClick:()=>t("/register"),className:"flex items-center space-x-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-8 py-3 rounded shadow-lg transform transition-transform duration-200 hover:-translate-y-1","aria-label":"Register",children:[e.jsx(ce,{size:22}),e.jsx("span",{children:"Register"})]}),e.jsxs("button",{onClick:()=>t("/login"),className:"flex items-center space-x-3 bg-white border border-blue-600 text-blue-600 font-semibold px-8 py-3 rounded shadow-lg hover:bg-blue-100 transform transition-transform duration-200 hover:-translate-y-1","aria-label":"Login",children:[e.jsx(me,{size:22}),e.jsx("span",{children:"Login"})]})]})]})};function $e(){const[t,c]=a.useState(""),[s,d]=a.useState(""),[i,n]=a.useState(!1),[r,h]=a.useState(""),[N,g]=a.useState(!1),{setToken:j,setRole:u,setName:f}=L(),v=_(),m=async o=>{var l,x;o.preventDefault(),h(""),g(!0);try{const y=await D.post("/api/login",{email:t,password:s}),{token:p,user:b}=y.data;localStorage.setItem("token",p),localStorage.setItem("role",b.role),localStorage.setItem("name",b.name),j(p),u(b.role),f(b.name),b.role==="user"?v("/user-dashboard"):b.role==="admin"?v("/admin-dashboard"):(localStorage.clear(),j(null),u(null),f(null),h("Unauthorized role"),v("/login"))}catch(y){h(((x=(l=y.response)==null?void 0:l.data)==null?void 0:x.message)||"Login failed")}finally{g(!1)}};return e.jsx("section",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-blue-200 px-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-semibold text-blue-800",children:"Pharmacy Login"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Secure access for pharmacy "})]}),r&&e.jsx("p",{className:"text-red-600 text-center mb-4 font-medium",children:r}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block mb-1 font-medium text-gray-700",children:"Email Address"}),e.jsx("input",{id:"email",type:"email",value:t,onChange:o=>c(o.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"you@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block mb-1 font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:i?"text":"password",value:s,onChange:o=>d(o.target.value),required:!0,className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password"}),e.jsx("button",{type:"button",onClick:()=>n(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-blue-600","aria-label":"Toggle password visibility",children:i?e.jsx(J,{}):e.jsx(Y,{})})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"remember",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember",className:"ml-2 text-sm text-gray-700",children:"Remember Me"})]}),e.jsx("button",{type:"submit",disabled:N,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md shadow-md disabled:opacity-70 disabled:cursor-not-allowed transition",children:N?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Login"})]}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-6",children:["Don't have an account?"," ",e.jsx(E,{to:"/register",className:"text-blue-600 hover:underline",children:"Register here"})]})]})})}function Re(){const[t,c]=a.useState({name:"",email:"",address:"",contact_no:"",dob:"",role:"user",password:"",password_confirmation:""}),[s,d]=a.useState(!1),[i,n]=a.useState(""),[r,h]=a.useState(!1),N=_(),g=u=>{const{name:f,value:v}=u.target;c(m=>({...m,[f]:v}))},j=async u=>{var f;if(u.preventDefault(),n(""),t.password!==t.password_confirmation){n("Passwords do not match");return}h(!0);try{await D.post("/api/register",t),N("/login")}catch(v){const m=(f=v.response)==null?void 0:f.data;n((m==null?void 0:m.message)||Object.values((m==null?void 0:m.errors)||{}).flat().join(" ")||"Registration failed")}finally{h(!1)}};return e.jsx("section",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-blue-200 px-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-lg shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-semibold text-blue-800",children:"Register"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create your pharmacy staff account"})]}),i&&e.jsx("p",{className:"text-red-600 text-center mb-4 font-medium",children:i}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Full Name",value:t.name,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email Address",value:t.email,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"text",name:"address",placeholder:"Address",value:t.address,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"text",name:"contact_no",placeholder:"Contact Number",value:t.contact_no,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"date",name:"dob",placeholder:"Date of Birth",value:t.dob,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsxs("select",{name:"role",value:t.role,onChange:g,className:"w-full px-4 py-3 border rounded-md",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:s?"text":"password",name:"password",placeholder:"Password",value:t.password,onChange:g,required:!0,className:"w-full px-4 py-3 pr-10 border rounded-md"}),e.jsx("button",{type:"button",onClick:()=>d(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:s?e.jsx(J,{}):e.jsx(Y,{})})]}),e.jsx("input",{type:s?"text":"password",name:"password_confirmation",placeholder:"Confirm Password",value:t.password_confirmation,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md disabled:opacity-70 disabled:cursor-not-allowed transition",children:r?"Creating account...":"Register"}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-4",children:["Already have an account?"," ",e.jsx(E,{to:"/login",className:"text-blue-600 hover:underline",children:"Login here"})]})]})]})})}const V=[{path:"/user-dashboard",icon:e.jsx(U,{}),label:"Dashboard"},{path:"/order-management",icon:e.jsx(xe,{}),label:"order"}],ee=()=>{const[t,c]=a.useState(!0),{logout:s}=L(),d=_(),i=()=>{c(r=>!r)},n=()=>{s(),d("/")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-gray-900 text-white transition-all duration-300 ${t?"w-64":"w-16"} fixed md:relative top-0 left-0 h-full z-50 flex flex-col hidden md:flex`,children:[e.jsx("button",{className:"text-white p-4 focus:outline-none hover:bg-gray-700 transition md:flex items-center justify-center",onClick:i,children:t?e.jsx(B,{size:24}):e.jsx(K,{size:24})}),e.jsx("ul",{className:"mt-4 space-y-2 flex-grow",children:V.map(r=>e.jsx("li",{children:e.jsxs(E,{to:r.path,className:"flex items-center p-2 hover:bg-gray-700 transition rounded-lg",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:r.icon}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:r.label})]})},r.path))}),e.jsx(O,{onConfirm:n,message:"Are you sure you want to logout?",children:e.jsxs("button",{className:"flex items-center p-2 mt-auto hover:bg-red-600 transition rounded-lg text-white w-full text-left",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:e.jsx(R,{})}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"Logout"})]})})]}),e.jsxs("div",{className:"bg-gray-900 text-white fixed bottom-0 left-0 w-full flex justify-around p-2 md:hidden z-50",children:[V.map(r=>e.jsx(E,{to:r.path,className:"flex flex-col items-center",children:e.jsx("span",{className:"text-xl",children:r.icon})},r.path)),e.jsx(O,{onConfirm:n,message:"Are you sure you want to logout?",children:e.jsx("button",{className:"flex flex-col items-center text-red-500",children:e.jsx("span",{className:"text-xl",children:e.jsx(R,{})})})})]})]})},Ie=()=>{const[t,c]=a.useState(null),[s,d]=a.useState(!0),[i,n]=a.useState("");return a.useEffect(()=>{(async()=>{try{const h=await D.get("/api/profile");c(h.data.user)}catch{n("Failed to load user profile")}finally{d(!1)}})()},[]),e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-blue-100 to-white overflow-hidden",children:[e.jsx(ee,{className:"w-64 flex-shrink-0"}),e.jsxs("main",{className:"flex-1 p-8 overflow-y-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-blue-800 mb-8",children:"üë§ User Dashboard"}),s?e.jsx("p",{className:"text-gray-600 text-lg",children:"Loading profile..."}):i?e.jsx("p",{className:"text-red-600 font-semibold",children:i}):e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-3xl mx-auto border border-blue-200",children:[e.jsx("h2",{className:"text-2xl font-semibold text-blue-700 mb-6",children:"üìã Profile Overview"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 text-gray-700 text-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Name:"})," ",t.name]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Email:"})," ",t.email]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Address:"})," ",t.address]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Contact:"})," ",t.contact_no]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"DOB:"})," ",t.dob]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Role:"})," ",t.role]})]})]})]})]})]})},Me=()=>{const t=_(),{name:c,role:s}=L(),[d,i]=a.useState({note:"",delivery_address:"",delivery_date:"",delivery_time:""}),[n,r]=a.useState([]),[h,N]=a.useState(!1),[g,j]=a.useState(null),[u,f]=a.useState(!1),[v,m]=a.useState(!1),o=b=>{i({...d,[b.target.name]:b.target.value})},l=b=>{const w=Array.from(b.target.files);if(w.filter(k=>k.size>50*1024).length>0){j("‚ùå One or more images exceed 50KB. Please choose smaller images.");return}r(k=>[...k,...w]),j(null)},x=b=>{r(w=>w.filter((S,k)=>k!==b))},y=b=>{if(b.preventDefault(),h)return;const{delivery_address:w,delivery_date:S,delivery_time:k}=d;if(!w||!S||!k){j("‚ùå Please fill in all required fields.");return}if(n.length===0){j("‚ùå Please upload at least one image.");return}if(n.filter(P=>P.size>50*1024).length>0){j("‚ùå All images must be smaller than 50KB.");return}j(null),f(!0)},p=async()=>{N(!0),j(null);const b=`${d.delivery_date} ${d.delivery_time}`,w=new FormData;w.append("note",d.note),w.append("delivery_address",d.delivery_address),w.append("delivery_time",b),n.forEach((S,k)=>{w.append(`images[${k}]`,S)});try{const S=await fetch("https://api.rashen.me/api/prescriptions",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:w});if(S.ok)m(!0),i({note:"",delivery_address:"",delivery_date:"",delivery_time:""}),r([]);else{let k="Something went wrong.";try{k=(await S.json()).message||k}catch{k=await S.text()||k}j(k)}}catch(S){console.error("Error:",S),j("An unexpected error occurred.")}finally{N(!1)}};return e.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-100 px-4",children:e.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl shadow-md w-full max-w-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"üìÑ Add New Prescription"}),v&&e.jsx("div",{className:"bg-green-100 text-green-700 px-4 py-3 rounded mb-4 text-center border border-green-400",children:"‚úÖ Prescription submitted successfully!"}),g&&e.jsx("div",{className:"bg-red-100 text-red-700 px-4 py-3 rounded mb-4 text-center border border-red-400",children:g}),e.jsxs("form",{onSubmit:y,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Delivery Address",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"delivery_address",placeholder:"Enter delivery address",value:d.delivery_address,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Delivery Date",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"delivery_date",value:d.delivery_date,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Delivery Time",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"time",name:"delivery_time",value:d.delivery_time,onChange:o,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-gray-700",children:"Notes (optional)"}),e.jsx("textarea",{name:"note",placeholder:"Write any additional notes here...",value:d.note,onChange:o,rows:"3",className:"w-full p-2 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Upload Prescription Images",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",name:"images",multiple:!0,accept:"image/png, image/jpeg",onChange:l,className:"w-full p-2 border border-gray-300 rounded-lg",required:n.length===0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload JPG/PNG images under 50KB each. You can upload multiple files."}),n.length>0&&e.jsx("ul",{className:"mt-3 space-y-2",children:n.map((b,w)=>e.jsxs("li",{className:"flex justify-between items-center text-sm bg-gray-100 p-2 rounded",children:[e.jsxs("span",{className:"truncate max-w-[70%]",children:[b.name," ‚Äî ",(b.size/1024).toFixed(1),"KB"]}),e.jsx("button",{type:"button",onClick:()=>x(w),className:"text-red-500 hover:text-red-700",title:"Remove",children:e.jsx(fe,{})})]},w))})]}),e.jsx(O,{open:u,message:"Confirm Prescription Submission",additionalInfo:"Double-check delivery date, time, address and uploaded images.",confirmText:"Yes, Submit",cancelText:"Cancel",icon:e.jsx(ye,{}),buttonBackgroundColor:"bg-blue-600",buttonTextColor:"text-white",onConfirm:()=>{f(!1),p()},onCancel:()=>f(!1),children:e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-300",disabled:h,children:h?"Submitting...":"Submit Prescription"})}),e.jsx("button",{type:"button",onClick:()=>t("/order-management"),className:"w-full mt-2 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition",children:"Cancel"})]})]})})},qe=()=>{const t=_(),{name:c,role:s}=L();return console.log("Logged in user:",c,"Role:",s),e.jsxs("div",{className:"flex flex-col md:flex-row h-screen",children:[e.jsx(ee,{}),e.jsxs("div",{className:"p-8 w-full overflow-auto",children:[e.jsxs("div",{className:"text-3xl font-semibold mb-8",children:[e.jsx("h1",{children:"Order Management"}),e.jsx("p",{className:"text-lg text-gray-500",children:"Manage your orders effectively"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(Ne,{className:"mr-2 text-blue-600"}),"Orders Now"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"orders quickly."}),e.jsx("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 w-full sm:w-auto",onClick:()=>t("/orders-now"),children:"Order now"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(ve,{className:"mr-2 text-green-600"}),"View All Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Browse your complete order history."}),e.jsx("button",{className:"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 w-full sm:w-auto",onClick:()=>t("/view-orders"),children:"View Orders"})]})]})]})]})},ze=()=>{var u,f,v,m,o;const{id:t}=M(),c=_(),[s,d]=a.useState(null),[i,n]=a.useState(null),[r,h]=a.useState(!1),N=async()=>{var l,x;try{const y=await D.get(`/api/prescriptions/${t}/summary`);d(y.data)}catch(y){n(((x=(l=y.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to load summary")}};a.useEffect(()=>{N()},[t]);const g=async()=>{var l,x;h(!0);try{await D.put(`/api/prescriptions/${t}`,{status:"approved"}),await N()}catch(y){n(((x=(l=y.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to approve")}finally{h(!1)}},j=async()=>{var l,x;if(window.confirm("Are you sure you want to reject (delete) this prescription?")){h(!0);try{await D.delete(`/api/prescriptions/${t}`),c("/view-orders")}catch(y){n(((x=(l=y.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to delete")}finally{h(!1)}}};return i?e.jsx("div",{className:"text-red-600 text-center mt-10",children:i}):s?e.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-xl shadow-lg mt-10",children:[e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:()=>c(-1),className:"text-sm px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded",children:"‚Üê Back"})}),e.jsxs("div",{className:"mb-6 bg-green-50 p-4 rounded shadow-sm",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"User Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",((u=s.user)==null?void 0:u.name)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",((f=s.user)==null?void 0:f.email)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((v=s.user)==null?void 0:v.address)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact No:"})," ",((m=s.user)==null?void 0:m.contact_no)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date of Birth:"})," ",(o=s.user)!=null&&o.dob?new Date(s.user.dob).toLocaleDateString():"-"]})]}),e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Prescription #",s.id]}),e.jsxs("div",{className:"space-y-2 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",s.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," ",s.note]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Address:"})," ",s.delivery_address]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Time:"})," ",new Date(s.delivery_time).toLocaleString()]})]}),e.jsx("h3",{className:"text-xl font-semibold mt-6 mb-2",children:"Drugs List"}),e.jsx("ul",{className:"bg-gray-50 p-4 rounded space-y-2 text-sm",children:s.prescription_list.map((l,x)=>e.jsxs("li",{className:"flex justify-between border-b pb-1",children:[e.jsxs("span",{children:[l.drug_name," (",l.quantity," √ó $",l.unit_price,")"]}),e.jsxs("span",{className:"font-semibold",children:["$",l.total]})]},x))}),e.jsxs("p",{className:"mt-4 font-bold text-right text-lg",children:["Total Price: $",s.total_price]}),s.status==="quotationed"&&e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:g,disabled:r,className:"px-5 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:"Approve"}),e.jsx("button",{onClick:j,disabled:r,className:"px-5 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:"Reject"})]})]}):e.jsx("div",{className:"text-center mt-10",children:"Loading summary..."})},Te=()=>{const t=_(),[c,s]=a.useState([]),[d,i]=a.useState(""),[n,r]=a.useState(""),[h,N]=a.useState(!0),[g,j]=a.useState(null),{name:u,role:f}=L();a.useEffect(()=>{(async()=>{var x,y;try{const p=await D.get("/api/prescriptions");s(p.data.prescriptions)}catch(p){j(((y=(x=p.response)==null?void 0:x.data)==null?void 0:y.message)||"Failed to fetch orders.")}finally{N(!1)}})()},[]);const v=a.useMemo(()=>c.filter(l=>{const x=n?l.status===n:!0,y=d?Object.values(l).some(p=>String(p).toLowerCase().includes(d.toLowerCase())):!0;return x&&y}),[c,n,d]),m=a.useMemo(()=>[{accessorKey:"id",header:"Order ID",cell:l=>{const x=l.getValue();return e.jsxs("button",{className:"text-teal-600 hover:underline text-sm",onClick:()=>t(`/prescriptions/${x}/summary`),children:["#",x]})}},{accessorKey:"status",header:"Status",cell:l=>e.jsx("span",{className:"capitalize text-sm",children:l.getValue()})},{accessorKey:"note",header:"Note",cell:l=>e.jsx("span",{className:"text-sm",children:l.getValue()||"-"})},{accessorKey:"delivery_address",header:"Delivery Address",cell:l=>e.jsx("span",{className:"text-sm",children:l.getValue()||"-"})},{accessorKey:"delivery_time",header:"Delivery Time",cell:l=>e.jsx("span",{className:"text-sm",children:l.getValue()?new Date(l.getValue()).toLocaleString():"-"})},{accessorKey:"created_at",header:"Created At",cell:l=>e.jsx("span",{className:"text-sm",children:new Date(l.getValue()).toLocaleString()})}],[t]),o=G({data:v,columns:m,state:{globalFilter:d},onGlobalFilterChange:i,getCoreRowModel:W(),getFilteredRowModel:H(),getPaginationRowModel:Q()});return e.jsxs("div",{className:"flex flex-col items-center min-h-screen bg-gray-50 py-8 relative",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-lg w-full max-w-6xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-gray-800 mb-6",children:"View All Orders"}),e.jsx("div",{className:"mb-4 flex flex-wrap gap-2 justify-center",children:["","pending","quotationed","approved","delivery","delivered"].map(l=>e.jsx("button",{onClick:()=>r(l),className:`px-4 py-1 rounded-full border transition ${n===l?"bg-blue-600 text-white border-blue-600":"bg-white text-blue-600 border-blue-600 hover:bg-blue-100"}`,children:l===""?"All":l.charAt(0).toUpperCase()+l.slice(1)},l||"all"))}),e.jsx("div",{className:"mb-6",children:e.jsx("input",{type:"text",placeholder:"Search by status, note, or address",value:d??"",onChange:l=>i(l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 text-gray-700"})}),h?e.jsx("div",{className:"text-center text-gray-500",children:"Loading..."}):g?e.jsx("div",{className:"text-center text-red-600",children:g}):v.length===0?e.jsx("div",{className:"text-center text-gray-500 py-10",children:"No orders found."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-teal-600 text-white",children:o.getHeaderGroups().map(l=>e.jsx("tr",{children:l.headers.map(x=>e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:I(x.column.columnDef.header,x.getContext())},x.id))},l.id))}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.getRowModel().rows.map(l=>e.jsx("tr",{className:"hover:bg-gray-50",children:l.getVisibleCells().map(x=>e.jsx("td",{className:"px-6 py-4",children:I(x.column.columnDef.cell,x.getContext())},x.id))},l.id))})]})}),e.jsxs("div",{className:"flex justify-center items-center mt-6 gap-4",children:[e.jsx("button",{disabled:!o.getCanPreviousPage(),onClick:()=>o.previousPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-gray-700",children:["Page ",o.getState().pagination.pageIndex+1," of ",o.getPageCount()]}),e.jsx("button",{disabled:!o.getCanNextPage(),onClick:()=>o.nextPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Next"})]})]})]}),e.jsx("button",{onClick:()=>t("/order-management"),className:"fixed bottom-8 right-8 bg-gray-800 text-white py-3 px-6 rounded-full shadow-lg hover:bg-gray-900 transition duration-200",children:"Back to Management"})]})};function Ve(){return e.jsx(we,{basename:"/xitebtest",children:e.jsx(Z,{children:e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsxs(Se,{children:[e.jsx(A,{path:"/",element:e.jsx(Oe,{})}),e.jsx(A,{path:"/login",element:e.jsx($e,{})}),e.jsx(A,{path:"/register",element:e.jsx(Re,{})}),e.jsx(A,{path:"/prescriptions/:id/summary",element:e.jsx(F,{children:e.jsx(ze,{})})}),e.jsx(A,{path:"/admin-all-orders",element:e.jsx(F,{children:e.jsx(Pe,{})})}),e.jsx(A,{path:"/order-management-admin",element:e.jsx(F,{children:e.jsx(Le,{})})}),e.jsx(A,{path:"/admin/orders/:id",element:e.jsx(F,{children:e.jsx(Ae,{})})}),e.jsx(A,{path:"/drugs",element:e.jsx(F,{children:e.jsx(Ee,{})})}),e.jsx(A,{path:"/admin-dashboard",element:e.jsx(F,{children:e.jsx(De,{})})}),e.jsx(A,{path:"/admin/prescriptions/:id/quotation",element:e.jsx(F,{children:e.jsx(Fe,{})})}),e.jsx(A,{path:"/user-dashboard",element:e.jsx(F,{children:e.jsx(Ie,{})})}),e.jsx(A,{path:"/order-management",element:e.jsx(F,{children:e.jsx(qe,{})})}),e.jsx(A,{path:"/orders-now",element:e.jsx(F,{children:e.jsx(Me,{})})}),e.jsx(A,{path:"/view-orders",element:e.jsx(F,{children:e.jsx(Te,{})})})]}),e.jsx(Ce,{})]})})})}ke.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(Z,{children:e.jsx(Ve,{})})}));
