import{r as a,j as e,N as ae,A as re,m as z,u as P,F as U,a as K,L,b as R,c as G,d as le,e as ne,f as oe,g as ie,h as de,i as Q,k as I,l as H,n as W,o as J,p as M,C as ce,q as me,s as xe,t as Y,v as X,w as ue,x as he,y as ge,z as pe,B as be,D as je,E as fe,G as ye,H as Ne,S as ve,I as we,J as Se,R as Ce,K as D,M as ke,O as De}from"./vendor-pseM5rMY.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function s(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerPolicy&&(i.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?i.credentials="include":d.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(d){if(d.ep)return;d.ep=!0;const i=s(d);fetch(d.href,i)}})();const Z=a.createContext(),F=()=>a.useContext(Z),ee=({children:t})=>{const[o,s]=a.useState(localStorage.getItem("token")||null),[c,d]=a.useState(localStorage.getItem("role")||null),[i,r]=a.useState(localStorage.getItem("name")||null);a.useEffect(()=>{o?(localStorage.setItem("token",o),localStorage.setItem("role",c),localStorage.setItem("name",i)):(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name"))},[o,c,i]);const h=()=>{s(null),d(null),r(null),localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name")};return e.jsx(Z.Provider,{value:{token:o,setToken:s,role:c,setRole:d,name:i,setName:r,logout:h},children:t})},E=({children:t})=>{const{token:o}=F();return o?t:e.jsx(ae,{to:"/login",replace:!0})},$=({onConfirm:t,children:o,message:s,additionalInfo:c,confirmText:d="Yes, Confirm",cancelText:i="Cancel",icon:r,buttonTextColor:h="text-white",buttonBackgroundColor:f="bg-red-600"})=>{const[g,y]=a.useState(!1),u=m=>{m.preventDefault(),y(!0)},j=()=>{y(!1),t()},v=()=>{y(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:g&&e.jsx(z.div,{className:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(z.div,{className:"bg-white p-8 rounded-2xl shadow-2xl space-y-6 w-96 max-w-md flex flex-col items-center justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[r&&e.jsx("div",{className:"text-4xl text-red-600",children:r}),e.jsx("p",{className:"text-xl font-semibold text-gray-800",children:s})]}),c&&e.jsx("div",{className:"text-sm text-gray-500 text-center",children:c}),e.jsxs("div",{className:"flex justify-center space-x-6 mt-6 w-full",children:[e.jsx("button",{onClick:v,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-md text-sm font-medium hover:bg-gray-400 transition duration-200",children:i}),e.jsx("button",{onClick:j,className:`${f} ${h} px-6 py-2 rounded-md text-sm font-medium hover:bg-opacity-90 transition duration-200`,children:d})]})]})})}),e.jsx("div",{onClick:u,children:o})]})},T=[{path:"/admin-dashboard",icon:e.jsx(G,{}),label:"Dashboard"},{path:"/order-management-admin",icon:e.jsx(le,{}),label:"Orders Management"},{path:"/drugs",icon:e.jsx(ne,{}),label:"Drugs"}],q=()=>{const[t,o]=a.useState(!0),{logout:s}=F(),c=P(),d=()=>{o(r=>!r)},i=()=>{s(),c("/")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-gray-900 text-white transition-all duration-300 ${t?"w-64":"w-16"} fixed md:relative top-0 left-0 h-full z-50 flex flex-col hidden md:flex`,children:[e.jsx("button",{className:"text-white p-4 focus:outline-none hover:bg-gray-700 transition md:flex items-center justify-center",onClick:d,children:t?e.jsx(U,{size:24}):e.jsx(K,{size:24})}),e.jsx("ul",{className:"mt-4 space-y-2 flex-grow",children:T.map(r=>e.jsx("li",{children:e.jsxs(L,{to:r.path,className:"flex items-center p-2 hover:bg-gray-700 transition rounded-lg",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:r.icon}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:r.label})]})},r.path))}),e.jsx($,{onConfirm:i,message:"Are you sure you want to logout?",children:e.jsxs("button",{className:"flex items-center p-2 mt-auto hover:bg-red-600 transition rounded-lg text-white w-full text-left",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:e.jsx(R,{})}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"Logout"})]})})]}),e.jsxs("div",{className:"bg-gray-900 text-white fixed bottom-0 left-0 w-full flex justify-around p-2 md:hidden z-50",children:[T.map(r=>e.jsx(L,{to:r.path,className:"flex flex-col items-center",children:e.jsx("span",{className:"text-xl",children:r.icon})},r.path)),e.jsx($,{onConfirm:i,message:"Are you sure you want to logout?",children:e.jsx("button",{className:"flex flex-col items-center text-red-500",children:e.jsx("span",{className:"text-xl",children:e.jsx(R,{})})})})]})]})},k=oe.create({baseURL:"https://api.rashen.me/",headers:{"Content-Type":"application/json"}});k.interceptors.request.use(t=>{const o=localStorage.getItem("token");return o&&(t.headers.Authorization=`Bearer ${o}`),t},t=>Promise.reject(t));k.interceptors.response.use(t=>t,t=>{var o;return((o=t.response)==null?void 0:o.status)===401&&(console.error("Unauthorized! Redirecting to login..."),localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(t)});const Pe=()=>{const[t,o]=a.useState(null),[s,c]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{const i=await k.get("/api/profile");o(i.data.user)}catch(i){console.error("Failed to fetch admin profile",i)}finally{c(!1)}})()},[]),e.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[e.jsx(q,{className:"w-64 flex-shrink-0"}),e.jsxs("main",{className:"flex-1 p-8 overflow-y-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-blue-800 mb-4",children:"🛠️ Admin Dashboard"}),!s&&t&&e.jsxs("p",{className:"text-lg text-gray-700 mb-6",children:["Welcome back, ",e.jsx("span",{className:"font-semibold text-blue-700",children:t.name}),"!"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-blue-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-blue-700 mb-2",children:"👥 Manage Users"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Add, edit, or remove users from the system."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-blue-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-blue-700 mb-2",children:"📄 View Prescriptions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Monitor all prescription records and status."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-blue-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-blue-700 mb-2",children:"⚙️ System Settings"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage roles, permissions, and platform settings."})]})]})]})]})},Ae=()=>{const t=P();return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-blue-50 p-6",children:[e.jsx("h1",{className:"text-5xl font-extrabold text-blue-900 mb-8 drop-shadow-md",children:"Welcome to Pharmacy"}),e.jsx("p",{className:"text-xl text-blue-700 mb-12 max-w-xl text-center",children:"Order now and get your medicines delivered fast and safely to your doorstep!"}),e.jsxs("div",{className:"space-x-6 flex flex-wrap justify-center",children:[e.jsxs("button",{onClick:()=>t("/register"),className:"flex items-center space-x-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-8 py-3 rounded shadow-lg transform transition-transform duration-200 hover:-translate-y-1","aria-label":"Register",children:[e.jsx(ie,{size:22}),e.jsx("span",{children:"Register"})]}),e.jsxs("button",{onClick:()=>t("/login"),className:"flex items-center space-x-3 bg-white border border-blue-600 text-blue-600 font-semibold px-8 py-3 rounded shadow-lg hover:bg-blue-100 transform transition-transform duration-200 hover:-translate-y-1","aria-label":"Login",children:[e.jsx(de,{size:22}),e.jsx("span",{children:"Login"})]})]})]})},_e=()=>{const t=P(),[o,s]=a.useState([]),[c,d]=a.useState(""),[i,r]=a.useState(""),[h,f]=a.useState(!0),[g,y]=a.useState(null),{name:u}=F();a.useEffect(()=>{(async()=>{var l,x;try{const N=await k.get("/api/admin/prescriptions");s(N.data.prescriptions)}catch(N){y(((x=(l=N.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to fetch orders.")}finally{f(!1)}})()},[]);const j=a.useMemo(()=>o.filter(n=>{const l=i?n.status===i:!0,x=c?Object.values(n).some(N=>String(N).toLowerCase().includes(c.toLowerCase())):!0;return l&&x}),[o,i,c]),v=a.useMemo(()=>[{accessorKey:"id",header:"Order ID",cell:n=>{const l=n.getValue();return e.jsxs("button",{className:"text-teal-600 hover:underline text-sm",onClick:()=>t(`/admin/orders/${l}`),children:["#",l]})}},{accessorKey:"user.name",header:"Customer Name",cell:n=>e.jsx("span",{className:"text-sm",children:n.getValue()||"-"})},{accessorKey:"status",header:"Status",cell:n=>e.jsx("span",{className:"capitalize text-sm font-medium text-gray-700",children:n.getValue()})},{accessorKey:"delivery_address",header:"Address",cell:n=>e.jsx("span",{className:"text-sm",children:n.getValue()||"-"})},{accessorKey:"delivery_time",header:"Delivery Time",cell:n=>e.jsx("span",{className:"text-sm",children:n.getValue()?new Date(n.getValue()).toLocaleString():"-"})},{accessorKey:"created_at",header:"Created At",cell:n=>e.jsx("span",{className:"text-sm",children:new Date(n.getValue()).toLocaleString()})}],[t]),m=Q({data:j,columns:v,state:{globalFilter:c},onGlobalFilterChange:d,getCoreRowModel:J(),getFilteredRowModel:W(),getPaginationRowModel:H()});return e.jsx("div",{className:"flex flex-col items-center min-h-screen bg-gray-50 py-10 px-4",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-xl w-full max-w-6xl p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:()=>t("/order-management"),className:"fixed bottom-6 right-6 bg-gray-800 text-white py-3 px-6 rounded-full shadow-lg hover:bg-gray-900 transition duration-200 z-50",children:"Back to Management"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"All Orders (Admin)"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Admin: ",u]})]}),e.jsx("div",{className:"mb-4 flex flex-wrap gap-2",children:["","pending","quotationed","approved","delivery","delivered"].map(n=>e.jsx("button",{onClick:()=>r(n),className:`px-4 py-1 rounded-full border ${i===n?"bg-blue-600 text-white border-blue-600":"bg-white text-blue-600 border-blue-600 hover:bg-blue-100"} transition`,children:n===""?"All":n.charAt(0).toUpperCase()+n.slice(1)},n||"all"))}),e.jsx("input",{type:"text",placeholder:"Search orders...",value:c??"",onChange:n=>d(n.target.value),className:"mb-6 w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 text-gray-700"}),h?e.jsx("p",{className:"text-center text-gray-600",children:"Loading..."}):g?e.jsx("p",{className:"text-center text-red-600",children:g}):j.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No orders available."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full border",children:[e.jsx("thead",{className:"bg-teal-600 text-white",children:m.getHeaderGroups().map(n=>e.jsx("tr",{children:n.headers.map(l=>e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:I(l.column.columnDef.header,l.getContext())},l.id))},n.id))}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.getRowModel().rows.map(n=>e.jsx("tr",{className:"hover:bg-gray-50",children:n.getVisibleCells().map(l=>e.jsx("td",{className:"px-6 py-4 text-sm",children:I(l.column.columnDef.cell,l.getContext())},l.id))},n.id))})]})}),e.jsxs("div",{className:"flex justify-center items-center mt-6 space-x-4",children:[e.jsx("button",{onClick:()=>m.previousPage(),disabled:!m.getCanPreviousPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",m.getState().pagination.pageIndex+1," of"," ",m.getPageCount()]}),e.jsx("button",{onClick:()=>m.nextPage(),disabled:!m.getCanNextPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Next"})]})]})]})})},V=()=>{var g,y,u,j,v;const{id:t}=M(),o=P(),[s,c]=a.useState(null),[d,i]=a.useState(!0),[r,h]=a.useState(null);a.useEffect(()=>{(async()=>{var n,l;try{const x=await k.get(`/api/admin/prescriptions/${t}`);c(x.data)}catch(x){h(((l=(n=x.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch order.")}finally{i(!1)}})()},[t]);const f=async()=>{if(s.status==="pending"){o(`/admin/prescriptions/${s.id}/quotation`);return}let m=null;if(s.status==="approved")m="delivery";else if(s.status==="delivery")m="delivered";else return;try{await k.put(`/api/admin/prescriptions/${s.id}/status`,{status:m}),c({...s,status:m})}catch{alert("Failed to update status.")}};return d?e.jsx("p",{className:"text-center mt-10",children:"Loading..."}):r?e.jsx("p",{className:"text-center text-red-600 mt-10",children:r}):e.jsxs("div",{className:"max-w-6xl mx-auto p-8 bg-white rounded-2xl shadow-lg mt-10 transition-all duration-300",children:[e.jsxs("h1",{className:"text-3xl font-extrabold mb-8 text-gray-900",children:["Order Summary ",e.jsxs("span",{className:"text-blue-600",children:["#",s.id]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2",children:"Customer Details"}),e.jsxs("ul",{className:"text-gray-600 space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Name:"})," ",(g=s.customer)==null?void 0:g.name]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",(y=s.customer)==null?void 0:y.email]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Address:"})," ",(u=s.customer)==null?void 0:u.address]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Contact:"})," ",(j=s.customer)==null?void 0:j.contact_no]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2",children:"Prescription Info"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:"capitalize text-blue-600",children:s.status})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," ",s.note||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Time:"})," ",s.delivery_time?new Date(s.delivery_time).toLocaleString():"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created At:"})," ",new Date(s.created_at).toLocaleString()]})]})]}),((v=s.images)==null?void 0:v.length)>0&&e.jsxs("div",{className:"mb-10",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2 mb-4",children:"Prescription Images"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:s.images.map(m=>e.jsx("img",{src:`data:image/jpeg;base64,${m.img}`,alt:"Prescription",className:"rounded-xl shadow-md border object-cover h-52 w-full hover:scale-105 transition-transform duration-300"},m.id))})]}),e.jsxs("div",{className:"mb-10 overflow-x-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 border-b pb-2 mb-4",children:"Prescription List"}),e.jsxs("table",{className:"w-full text-sm text-left border border-gray-300 rounded-xl overflow-hidden shadow",children:[e.jsx("thead",{className:"bg-blue-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Drug"}),e.jsx("th",{className:"px-4 py-3",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-3",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white",children:s.prescription_list.map((m,n)=>e.jsxs("tr",{className:"border-t hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-2",children:m.drug_name}),e.jsx("td",{className:"px-4 py-2",children:m.quantity}),e.jsxs("td",{className:"px-4 py-2",children:["LKR ",m.unit_price]}),e.jsxs("td",{className:"px-4 py-2 font-medium",children:["LKR ",m.total]})]},n))})]})]}),e.jsxs("div",{className:"text-right text-2xl font-bold text-gray-900 mb-8",children:["Total: ",e.jsxs("span",{className:"text-green-600",children:["LKR ",s.total_price]})]}),["pending","approved","delivery"].includes(s.status)&&e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("button",{onClick:f,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl transition-colors duration-300",children:[s.status==="pending"&&"Create Quotation",s.status==="approved"&&"Mark as Delivery",s.status==="delivery"&&"Mark as Delivered"]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>o(-1),className:"bg-gray-800 hover:bg-gray-900 text-white px-6 py-3 rounded-xl transition-colors duration-300",children:"← Back"})})]})},Fe=({value:t,onChange:o,allDrugs:s})=>{const[c,d]=a.useState(t||""),[i,r]=a.useState([]),[h,f]=a.useState(!1),g=a.useRef();a.useEffect(()=>{if(c.trim()===""){r([]);return}const u=s.filter(j=>j.name.toLowerCase().includes(c.toLowerCase()));r(u)},[c,s]),a.useEffect(()=>{const u=j=>{g.current&&!g.current.contains(j.target)&&f(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]);const y=u=>{d(u.name),o(u.name,Number(u.price),u.id),f(!1)};return e.jsxs("div",{className:"relative",ref:g,children:[e.jsx("input",{type:"text",placeholder:"Type drug name",value:c,onChange:u=>{d(u.target.value),o(u.target.value,0,null),f(!0)},onFocus:()=>f(!0),className:"border px-4 py-2 rounded w-full"}),h&&i.length>0&&e.jsx("ul",{className:"absolute z-10 bg-white border w-full max-h-48 overflow-auto rounded shadow-md mt-1",children:i.map(u=>e.jsxs("li",{className:"px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:()=>y(u),children:[u.name," - $",Number(u.price).toFixed(2)]},u.id))}),h&&i.length===0&&e.jsx("div",{className:"absolute z-10 bg-white border w-full rounded mt-1 px-4 py-2 text-gray-500",children:"No drugs found"})]})},Le=()=>{var N,p,b,w,S,_;const{id:t}=M(),o=P(),[s,c]=a.useState(null),[d,i]=a.useState([]),[r,h]=a.useState({drug_name:"",quantity:1,unit_price:0,drug_id:null}),[f,g]=a.useState([]),[y,u]=a.useState(0),[j,v]=a.useState(!0),[m,n]=a.useState(null);a.useEffect(()=>{(async()=>{try{const[A,O]=await Promise.all([k.get(`/api/admin/prescriptions/${t}`),k.get("/api/drugs")]);c(A.data),g(O.data)}catch{n("Failed to load data.")}finally{v(!1)}})()},[t]);const l=()=>{!r.drug_id||!r.drug_name||(i([...d,{...r}]),h({drug_name:"",quantity:1,unit_price:0,drug_id:null}))},x=async()=>{try{for(const C of d)await k.post("/api/prescriptionlist-items",{prescription_id:t,drug_id:C.drug_id,quantity:C.quantity,unit_price:C.unit_price});await k.put(`/api/admin/prescriptions/${t}/status`,{status:"quotationed"}),o(`/admin/orders/${t}`)}catch(C){console.error(C),alert("Failed to create quotation or update status.")}};return j?e.jsx("p",{className:"text-center mt-10",children:"Loading..."}):m?e.jsx("p",{className:"text-center text-red-600 mt-10",children:m}):e.jsxs("div",{className:"max-w-5xl mx-auto p-8 bg-white mt-10 rounded-xl shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:["Create Quotation for Prescription #",t]}),((N=s==null?void 0:s.images)==null?void 0:N.length)>0&&e.jsxs("div",{className:"mb-8 border-b border-gray-200 pb-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:`data:image/jpeg;base64,${(p=s.images[y])==null?void 0:p.img}`,alt:"Main Prescription",className:"max-h-96 rounded-xl shadow-md border object-contain"})}),e.jsx("div",{className:"flex space-x-4 overflow-x-auto",children:s.images.map((C,A)=>e.jsx("img",{src:`data:image/jpeg;base64,${C.img}`,alt:`Thumbnail ${A+1}`,onClick:()=>u(A),className:`h-24 w-24 object-cover rounded-md border cursor-pointer ${A===y?"ring-2 ring-blue-500 scale-105":"opacity-70 hover:opacity-100"}`},C.id||A))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8 text-sm text-gray-700",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"font-semibold border-b pb-1",children:"Customer Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",((b=s==null?void 0:s.customer)==null?void 0:b.name)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",((w=s==null?void 0:s.customer)==null?void 0:w.email)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((S=s==null?void 0:s.customer)==null?void 0:S.address)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",((_=s==null?void 0:s.customer)==null?void 0:_.contact_no)||"-"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"font-semibold border-b pb-1",children:"Prescription Info"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:"capitalize text-blue-600",children:(s==null?void 0:s.status)||"-"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," ",(s==null?void 0:s.note)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Time:"})," ",s!=null&&s.delivery_time?new Date(s.delivery_time).toLocaleString():"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created At:"})," ",s!=null&&s.created_at?new Date(s.created_at).toLocaleString():"-"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add Drug"}),e.jsx(Fe,{value:r.drug_name,allDrugs:f,onChange:(C,A,O)=>{h({...r,drug_name:C,unit_price:A,drug_id:O})}}),e.jsx("input",{type:"number",min:"1",value:r.quantity,onChange:C=>h({...r,quantity:parseInt(C.target.value)||1}),placeholder:"Quantity",className:"border px-4 py-2 rounded w-full mt-2"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:r.unit_price,onChange:C=>h({...r,unit_price:parseFloat(C.target.value)||0}),placeholder:"Unit Price",className:"border px-4 py-2 rounded w-full mt-2"}),e.jsx("button",{onClick:l,className:"bg-green-600 text-white px-4 py-2 rounded mt-4 hover:bg-green-700",children:"+ Add Drug"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Added Drugs"}),d.length===0?e.jsx("p",{className:"text-gray-500",children:"No drugs added yet."}):e.jsx("ul",{className:"space-y-3",children:d.map((C,A)=>e.jsxs("li",{className:"p-4 border rounded bg-gray-50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:C.drug_name}),e.jsxs("p",{className:"text-sm",children:["Qty: ",C.quantity,", Price: $",C.unit_price.toFixed(2)]})]}),e.jsx("button",{onClick:()=>i(d.filter((O,te)=>te!==A)),className:"text-red-500 hover:underline text-sm",children:"Remove"})]},A))})]})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx("button",{onClick:x,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Submit Quotation"}),e.jsx("button",{onClick:()=>o(-1),className:"text-sm text-gray-600 underline hover:text-gray-900",children:"← Go Back"})]})]})},Ee=()=>{const t=P(),{name:o,role:s}=F();return console.log("Admin user:",o,"Role:",s),e.jsxs("div",{className:"flex flex-col md:flex-row h-screen",children:[e.jsx(q,{}),e.jsxs("div",{className:"p-8 w-full overflow-auto",children:[e.jsxs("div",{className:"text-3xl font-semibold mb-8",children:[e.jsx("h1",{children:"Order Management"}),e.jsx("p",{className:"text-lg text-gray-500",children:"Monitor, process, and manage all orders"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(ce,{className:"mr-2 text-blue-600"}),"View All Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Access all order details in one place."}),e.jsx("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 w-full sm:w-auto",onClick:()=>t("/admin-all-orders"),children:"View Orders"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(me,{className:"mr-2 text-yellow-500"}),"Pending Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Review and take action on pending orders."}),e.jsx("button",{className:"bg-yellow-500 text-white py-2 px-4 rounded-lg hover:bg-yellow-600 w-full sm:w-auto",onClick:()=>t("/admin/orders/pending"),children:"Pending Orders"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(xe,{className:"mr-2 text-green-600"}),"Completed Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"View history of all fulfilled orders."}),e.jsx("button",{className:"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 w-full sm:w-auto",onClick:()=>t("/admin/orders/completed"),children:"Completed Orders"})]})]})]})]})};function $e(){const[t,o]=a.useState(""),[s,c]=a.useState(""),[d,i]=a.useState(!1),[r,h]=a.useState(""),[f,g]=a.useState(!1),{setToken:y,setRole:u,setName:j}=F(),v=P(),m=async n=>{var l,x;n.preventDefault(),h(""),g(!0);try{const N=await k.post("/api/login",{email:t,password:s}),{token:p,user:b}=N.data;localStorage.setItem("token",p),localStorage.setItem("role",b.role),localStorage.setItem("name",b.name),y(p),u(b.role),j(b.name),b.role==="user"?v("/user-dashboard"):b.role==="admin"?v("/admin-dashboard"):(localStorage.clear(),y(null),u(null),j(null),h("Unauthorized role"),v("/login"))}catch(N){h(((x=(l=N.response)==null?void 0:l.data)==null?void 0:x.message)||"Login failed")}finally{g(!1)}};return e.jsx("section",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-blue-200 px-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-semibold text-blue-800",children:"Pharmacy Login"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Secure access for pharmacy "})]}),r&&e.jsx("p",{className:"text-red-600 text-center mb-4 font-medium",children:r}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block mb-1 font-medium text-gray-700",children:"Email Address"}),e.jsx("input",{id:"email",type:"email",value:t,onChange:n=>o(n.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"you@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block mb-1 font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:d?"text":"password",value:s,onChange:n=>c(n.target.value),required:!0,className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password"}),e.jsx("button",{type:"button",onClick:()=>i(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-blue-600","aria-label":"Toggle password visibility",children:d?e.jsx(Y,{}):e.jsx(X,{})})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"remember",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember",className:"ml-2 text-sm text-gray-700",children:"Remember Me"})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md shadow-md disabled:opacity-70 disabled:cursor-not-allowed transition",children:f?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Login"})]}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-6",children:["Don't have an account?"," ",e.jsx(L,{to:"/register",className:"text-blue-600 hover:underline",children:"Register here"})]})]})})}const Oe=()=>{const[t,o]=a.useState([]),[s,c]=a.useState(!0),[d,i]=a.useState(null),[r,h]=a.useState({id:null,name:"",price:""}),[f,g]=a.useState(""),[y,u]=a.useState("list"),j="https://api.rashen.me/",v=()=>localStorage.getItem("token"),m=async()=>{c(!0),i(null);try{const p=await fetch(`${j}/api/drugs`,{headers:{Authorization:`Bearer ${v()}`}});if(!p.ok)throw new Error(`Failed to load drugs (${p.status})`);const w=(await p.json()).map(S=>({...S,price:Number(S.price)}));o(w)}catch(p){i(p.message)}finally{c(!1)}};a.useEffect(()=>{m()},[]);const n=p=>{const{name:b,value:w}=p.target;h(S=>({...S,[b]:w}))},l=async p=>{if(p.preventDefault(),g(""),!r.name.trim()||!r.price){g("Please fill in all fields.");return}try{const b=r.id?"PUT":"POST",w=r.id?`${j}/api/drugs/${r.id}`:`${j}/api/drugs`,S=await fetch(w,{method:b,headers:{"Content-Type":"application/json",Authorization:`Bearer ${v()}`},body:JSON.stringify({name:r.name.trim(),price:parseFloat(r.price)})});if(!S.ok){const _=await S.json();throw new Error(_.message||`Failed to save drug (${S.status})`)}h({id:null,name:"",price:""}),m(),u("list")}catch(b){g(b.message)}},x=p=>{h({id:p.id,name:p.name,price:p.price.toString()}),g(""),u("form")},N=async p=>{if(window.confirm("Are you sure you want to delete this drug?"))try{const b=await fetch(`${j}/api/drugs/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${v()}`}});if(!b.ok){const w=await b.json();throw new Error(w.message||`Failed to delete drug (${b.status})`)}m()}catch(b){alert(b.message)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsx("div",{children:e.jsx(q,{className:"w-64 flex-shrink-0"})}),e.jsxs("div",{className:"flex-grow p-8 max-w-7xl mx-auto w-full",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Manage Drugs"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsxs("div",{className:"md:w-1/3 bg-white shadow rounded-lg p-6",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsx("button",{className:"px-4 py-2 rounded bg-teal-600 text-white hover:bg-teal-700",onClick:()=>{h({id:null,name:"",price:""}),g(""),u("form")},children:"Add New Drug"})}),y==="form"&&e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:l,className:"flex flex-col gap-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Drug Name",value:r.name,onChange:n,className:"p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0}),e.jsx("input",{type:"number",name:"price",placeholder:"Price",min:"0",step:"0.01",value:r.price,onChange:n,className:"p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0}),e.jsx("button",{type:"submit",className:"bg-teal-600 text-white px-6 py-2 rounded hover:bg-teal-700 transition",children:r.id?"Update Drug":"Add Drug"})]}),f&&e.jsx("p",{className:"text-red-600 mt-4 text-center font-medium",children:f})]}),y==="list"&&e.jsx("p",{className:"text-center text-gray-500 mt-8",children:'Select "View Drugs List" on the right to see drugs.'})]}),e.jsx("div",{className:"md:w-2/3 bg-white shadow rounded-lg p-6 overflow-auto max-h-[600px]",children:s?e.jsx("p",{className:"text-center text-gray-500",children:"Loading drugs..."}):d?e.jsx("p",{className:"text-center text-red-600",children:d}):t.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No drugs available."}):e.jsxs("table",{className:"w-full border border-gray-300 rounded table-auto",children:[e.jsx("thead",{className:"bg-teal-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Price ($)"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(p=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onDoubleClick:()=>x(p),children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:p.name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:p.price!=null?p.price.toFixed(2):"0.00"}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-center space-x-4",children:[e.jsx("button",{onClick:()=>x(p),className:"text-teal-600 hover:underline",type:"button",children:"Edit"}),e.jsx("button",{onClick:()=>N(p.id),className:"text-red-600 hover:underline",type:"button",children:"Delete"})]})]},p.id))})]})})]})]})]})};function Re(){const[t,o]=a.useState({name:"",email:"",address:"",contact_no:"",dob:"",role:"user",password:"",password_confirmation:""}),[s,c]=a.useState(!1),[d,i]=a.useState(""),[r,h]=a.useState(!1),f=P(),g=u=>{const{name:j,value:v}=u.target;o(m=>({...m,[j]:v}))},y=async u=>{var j;if(u.preventDefault(),i(""),t.password!==t.password_confirmation){i("Passwords do not match");return}h(!0);try{await k.post("/api/register",t),f("/login")}catch(v){const m=(j=v.response)==null?void 0:j.data;i((m==null?void 0:m.message)||Object.values((m==null?void 0:m.errors)||{}).flat().join(" ")||"Registration failed")}finally{h(!1)}};return e.jsx("section",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-blue-200 px-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-lg shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-semibold text-blue-800",children:"Register"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create your pharmacy staff account"})]}),d&&e.jsx("p",{className:"text-red-600 text-center mb-4 font-medium",children:d}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Full Name",value:t.name,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email Address",value:t.email,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"text",name:"address",placeholder:"Address",value:t.address,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"text",name:"contact_no",placeholder:"Contact Number",value:t.contact_no,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("input",{type:"date",name:"dob",placeholder:"Date of Birth",value:t.dob,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsxs("select",{name:"role",value:t.role,onChange:g,className:"w-full px-4 py-3 border rounded-md",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:s?"text":"password",name:"password",placeholder:"Password",value:t.password,onChange:g,required:!0,className:"w-full px-4 py-3 pr-10 border rounded-md"}),e.jsx("button",{type:"button",onClick:()=>c(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:s?e.jsx(Y,{}):e.jsx(X,{})})]}),e.jsx("input",{type:s?"text":"password",name:"password_confirmation",placeholder:"Confirm Password",value:t.password_confirmation,onChange:g,required:!0,className:"w-full px-4 py-3 border rounded-md"}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md disabled:opacity-70 disabled:cursor-not-allowed transition",children:r?"Creating account...":"Register"}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-4",children:["Already have an account?"," ",e.jsx(L,{to:"/login",className:"text-blue-600 hover:underline",children:"Login here"})]})]})]})})}const B=[{path:"/user-dashboard",icon:e.jsx(G,{}),label:"Dashboard"},{path:"/order-management",icon:e.jsx(ue,{}),label:"order"}],se=()=>{const[t,o]=a.useState(!0),{logout:s}=F(),c=P(),d=()=>{o(r=>!r)},i=()=>{s(),c("/")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-gray-900 text-white transition-all duration-300 ${t?"w-64":"w-16"} fixed md:relative top-0 left-0 h-full z-50 flex flex-col hidden md:flex`,children:[e.jsx("button",{className:"text-white p-4 focus:outline-none hover:bg-gray-700 transition md:flex items-center justify-center",onClick:d,children:t?e.jsx(U,{size:24}):e.jsx(K,{size:24})}),e.jsx("ul",{className:"mt-4 space-y-2 flex-grow",children:B.map(r=>e.jsx("li",{children:e.jsxs(L,{to:r.path,className:"flex items-center p-2 hover:bg-gray-700 transition rounded-lg",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:r.icon}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:r.label})]})},r.path))}),e.jsx($,{onConfirm:i,message:"Are you sure you want to logout?",children:e.jsxs("button",{className:"flex items-center p-2 mt-auto hover:bg-red-600 transition rounded-lg text-white w-full text-left",children:[e.jsx("span",{className:"text-xl ml-4 mr-4",children:e.jsx(R,{})}),e.jsx("span",{className:`transition-all duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"Logout"})]})})]}),e.jsxs("div",{className:"bg-gray-900 text-white fixed bottom-0 left-0 w-full flex justify-around p-2 md:hidden z-50",children:[B.map(r=>e.jsx(L,{to:r.path,className:"flex flex-col items-center",children:e.jsx("span",{className:"text-xl",children:r.icon})},r.path)),e.jsx($,{onConfirm:i,message:"Are you sure you want to logout?",children:e.jsx("button",{className:"flex flex-col items-center text-red-500",children:e.jsx("span",{className:"text-xl",children:e.jsx(R,{})})})})]})]})},Ie=()=>{const[t,o]=a.useState(null),[s,c]=a.useState(!0),[d,i]=a.useState("");return a.useEffect(()=>{(async()=>{try{const h=await k.get("/api/profile");o(h.data.user)}catch{i("Failed to load user profile")}finally{c(!1)}})()},[]),e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-blue-100 to-white overflow-hidden",children:[e.jsx(se,{className:"w-64 flex-shrink-0"}),e.jsxs("main",{className:"flex-1 p-8 overflow-y-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-blue-800 mb-8",children:"👤 User Dashboard"}),s?e.jsx("p",{className:"text-gray-600 text-lg",children:"Loading profile..."}):d?e.jsx("p",{className:"text-red-600 font-semibold",children:d}):e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-3xl mx-auto border border-blue-200",children:[e.jsx("h2",{className:"text-2xl font-semibold text-blue-700 mb-6",children:"📋 Profile Overview"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 text-gray-700 text-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Name:"})," ",t.name]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Email:"})," ",t.email]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Address:"})," ",t.address]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Contact:"})," ",t.contact_no]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"DOB:"})," ",t.dob]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fe,{className:"text-blue-600 text-xl"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Role:"})," ",t.role]})]})]})]})]})]})},Me=()=>{const t=P(),[o,s]=a.useState({note:"",delivery_address:"",delivery_date:"",delivery_time:""}),[c,d]=a.useState([]),[i,r]=a.useState(!1),[h,f]=a.useState(null),[g,y]=a.useState(!1),[u,j]=a.useState(!1),{name:v,role:m}=F(),n=b=>{s({...o,[b.target.name]:b.target.value})},l=b=>{const w=Array.from(b.target.files);d(S=>[...S,...w])},x=b=>{d(w=>w.filter((S,_)=>_!==b))},N=async()=>{r(!0),f(null);const b=`${o.delivery_date} ${o.delivery_time}`,w=new FormData;w.append("note",o.note),w.append("delivery_address",o.delivery_address),w.append("delivery_time",b),c.forEach((S,_)=>{w.append(`images[${_}]`,S)});try{const S=await fetch("https://api.rashen.me//api/prescriptions",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:w});if(S.ok)j(!0),s({note:"",delivery_address:"",delivery_date:"",delivery_time:""}),d([]);else{const _=await S.json();f(_.message||"Something went wrong.")}}catch(S){console.error("Error:",S),f("An unexpected error occurred.")}finally{r(!1)}},p=b=>{b.preventDefault(),y(!0)};return e.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-100 px-4",children:e.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl shadow-md w-full max-w-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"📄 Add New Prescription"}),u&&e.jsx("div",{className:"bg-green-100 text-green-700 px-4 py-3 rounded mb-4 text-center border border-green-400",children:"✅ Prescription submitted successfully!"}),h&&e.jsxs("div",{className:"bg-red-100 text-red-700 px-4 py-3 rounded mb-4 text-center border border-red-400",children:["❌ ",h]}),e.jsxs("form",{onSubmit:p,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Delivery Address",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"delivery_address",placeholder:"Enter delivery address",value:o.delivery_address,onChange:n,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Delivery Date",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"delivery_date",value:o.delivery_date,onChange:n,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Delivery Time",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"time",name:"delivery_time",value:o.delivery_time,onChange:n,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-gray-700",children:"Notes (optional)"}),e.jsx("textarea",{name:"note",placeholder:"Write any additional notes here...",value:o.note,onChange:n,rows:"3",className:"w-full p-2 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-medium text-gray-700",children:["Upload Prescription Images",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",name:"images",multiple:!0,accept:"image/png, image/jpeg",onChange:l,className:"w-full p-2 border border-gray-300 rounded-lg",required:c.length===0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"You can upload multiple JPG/PNG images."}),c.length>0&&e.jsx("ul",{className:"mt-3 space-y-2",children:c.map((b,w)=>e.jsxs("li",{className:"flex justify-between items-center text-sm bg-gray-100 p-2 rounded",children:[e.jsx("span",{className:"truncate max-w-[70%]",children:b.name}),e.jsx("button",{type:"button",onClick:()=>x(w),className:"text-red-500 hover:text-red-700",title:"Remove",children:e.jsx(ye,{})})]},w))})]}),e.jsx($,{open:g,message:"Confirm Prescription Submission",additionalInfo:"Double-check delivery date, time, address and uploaded images.",confirmText:"Yes, Submit",cancelText:"Cancel",icon:e.jsx(Ne,{}),buttonBackgroundColor:"bg-blue-600",buttonTextColor:"text-white",onConfirm:()=>{y(!1),N()},onCancel:()=>y(!1),children:e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-300",disabled:i,children:i?"Submitting...":"Submit Prescription"})}),e.jsx("button",{type:"button",onClick:()=>t("/order-management"),className:"w-full mt-2 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition",children:"Cancel"})]})]})})},qe=()=>{const t=P(),{name:o,role:s}=F();return console.log("Logged in user:",o,"Role:",s),e.jsxs("div",{className:"flex flex-col md:flex-row h-screen",children:[e.jsx(se,{}),e.jsxs("div",{className:"p-8 w-full overflow-auto",children:[e.jsxs("div",{className:"text-3xl font-semibold mb-8",children:[e.jsx("h1",{children:"Order Management"}),e.jsx("p",{className:"text-lg text-gray-500",children:"Manage your orders effectively"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(ve,{className:"mr-2 text-blue-600"}),"Orders Now"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"orders quickly."}),e.jsx("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 w-full sm:w-auto",onClick:()=>t("/orders-now"),children:"Order now"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-2xl transition duration-300",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(we,{className:"mr-2 text-green-600"}),"View All Orders"]}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Browse your complete order history."}),e.jsx("button",{className:"bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 w-full sm:w-auto",onClick:()=>t("/view-orders"),children:"View Orders"})]})]})]})]})},ze=()=>{var u,j,v,m,n;const{id:t}=M(),o=P(),[s,c]=a.useState(null),[d,i]=a.useState(null),[r,h]=a.useState(!1),f=async()=>{var l,x;try{const N=await k.get(`/api/prescriptions/${t}/summary`);c(N.data)}catch(N){i(((x=(l=N.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to load summary")}};a.useEffect(()=>{f()},[t]);const g=async()=>{var l,x;h(!0);try{await k.put(`/api/prescriptions/${t}`,{status:"approved"}),await f()}catch(N){i(((x=(l=N.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to approve")}finally{h(!1)}},y=async()=>{var l,x;if(window.confirm("Are you sure you want to reject (delete) this prescription?")){h(!0);try{await k.delete(`/api/prescriptions/${t}`),o("/view-orders")}catch(N){i(((x=(l=N.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to delete")}finally{h(!1)}}};return d?e.jsx("div",{className:"text-red-600 text-center mt-10",children:d}):s?e.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-xl shadow-lg mt-10",children:[e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:()=>o(-1),className:"text-sm px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded",children:"← Back"})}),e.jsxs("div",{className:"mb-6 bg-green-50 p-4 rounded shadow-sm",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"User Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",((u=s.user)==null?void 0:u.name)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",((j=s.user)==null?void 0:j.email)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((v=s.user)==null?void 0:v.address)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact No:"})," ",((m=s.user)==null?void 0:m.contact_no)||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date of Birth:"})," ",(n=s.user)!=null&&n.dob?new Date(s.user.dob).toLocaleDateString():"-"]})]}),e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Prescription #",s.id]}),e.jsxs("div",{className:"space-y-2 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",s.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," ",s.note]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Address:"})," ",s.delivery_address]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Delivery Time:"})," ",new Date(s.delivery_time).toLocaleString()]})]}),e.jsx("h3",{className:"text-xl font-semibold mt-6 mb-2",children:"Drugs List"}),e.jsx("ul",{className:"bg-gray-50 p-4 rounded space-y-2 text-sm",children:s.prescription_list.map((l,x)=>e.jsxs("li",{className:"flex justify-between border-b pb-1",children:[e.jsxs("span",{children:[l.drug_name," (",l.quantity," × $",l.unit_price,")"]}),e.jsxs("span",{className:"font-semibold",children:["$",l.total]})]},x))}),e.jsxs("p",{className:"mt-4 font-bold text-right text-lg",children:["Total Price: $",s.total_price]}),s.status==="quotationed"&&e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:g,disabled:r,className:"px-5 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:"Approve"}),e.jsx("button",{onClick:y,disabled:r,className:"px-5 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:"Reject"})]})]}):e.jsx("div",{className:"text-center mt-10",children:"Loading summary..."})},Te=()=>{const t=P(),[o,s]=a.useState([]),[c,d]=a.useState(""),[i,r]=a.useState(""),[h,f]=a.useState(!0),[g,y]=a.useState(null),{name:u,role:j}=F();a.useEffect(()=>{(async()=>{var x,N;try{const p=await k.get("/api/prescriptions");s(p.data.prescriptions)}catch(p){y(((N=(x=p.response)==null?void 0:x.data)==null?void 0:N.message)||"Failed to fetch orders.")}finally{f(!1)}})()},[]);const v=a.useMemo(()=>o.filter(l=>{const x=i?l.status===i:!0,N=c?Object.values(l).some(p=>String(p).toLowerCase().includes(c.toLowerCase())):!0;return x&&N}),[o,i,c]),m=a.useMemo(()=>[{accessorKey:"id",header:"Order ID",cell:l=>{const x=l.getValue();return e.jsxs("button",{className:"text-teal-600 hover:underline text-sm",onClick:()=>t(`/prescriptions/${x}/summary`),children:["#",x]})}},{accessorKey:"status",header:"Status",cell:l=>e.jsx("span",{className:"capitalize text-sm",children:l.getValue()})},{accessorKey:"note",header:"Note",cell:l=>e.jsx("span",{className:"text-sm",children:l.getValue()||"-"})},{accessorKey:"delivery_address",header:"Delivery Address",cell:l=>e.jsx("span",{className:"text-sm",children:l.getValue()||"-"})},{accessorKey:"delivery_time",header:"Delivery Time",cell:l=>e.jsx("span",{className:"text-sm",children:l.getValue()?new Date(l.getValue()).toLocaleString():"-"})},{accessorKey:"created_at",header:"Created At",cell:l=>e.jsx("span",{className:"text-sm",children:new Date(l.getValue()).toLocaleString()})}],[t]),n=Q({data:v,columns:m,state:{globalFilter:c},onGlobalFilterChange:d,getCoreRowModel:J(),getFilteredRowModel:W(),getPaginationRowModel:H()});return e.jsxs("div",{className:"flex flex-col items-center min-h-screen bg-gray-50 py-8 relative",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-lg w-full max-w-6xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-gray-800 mb-6",children:"View All Orders"}),e.jsx("div",{className:"mb-4 flex flex-wrap gap-2 justify-center",children:["","pending","quotationed","approved","delivery","delivered"].map(l=>e.jsx("button",{onClick:()=>r(l),className:`px-4 py-1 rounded-full border transition ${i===l?"bg-blue-600 text-white border-blue-600":"bg-white text-blue-600 border-blue-600 hover:bg-blue-100"}`,children:l===""?"All":l.charAt(0).toUpperCase()+l.slice(1)},l||"all"))}),e.jsx("div",{className:"mb-6",children:e.jsx("input",{type:"text",placeholder:"Search by status, note, or address",value:c??"",onChange:l=>d(l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 text-gray-700"})}),h?e.jsx("div",{className:"text-center text-gray-500",children:"Loading..."}):g?e.jsx("div",{className:"text-center text-red-600",children:g}):v.length===0?e.jsx("div",{className:"text-center text-gray-500 py-10",children:"No orders found."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-teal-600 text-white",children:n.getHeaderGroups().map(l=>e.jsx("tr",{children:l.headers.map(x=>e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium",children:I(x.column.columnDef.header,x.getContext())},x.id))},l.id))}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.getRowModel().rows.map(l=>e.jsx("tr",{className:"hover:bg-gray-50",children:l.getVisibleCells().map(x=>e.jsx("td",{className:"px-6 py-4",children:I(x.column.columnDef.cell,x.getContext())},x.id))},l.id))})]})}),e.jsxs("div",{className:"flex justify-center items-center mt-6 gap-4",children:[e.jsx("button",{disabled:!n.getCanPreviousPage(),onClick:()=>n.previousPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-gray-700",children:["Page ",n.getState().pagination.pageIndex+1," of ",n.getPageCount()]}),e.jsx("button",{disabled:!n.getCanNextPage(),onClick:()=>n.nextPage(),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 disabled:opacity-50",children:"Next"})]})]})]}),e.jsx("button",{onClick:()=>t("/order-management"),className:"fixed bottom-8 right-8 bg-gray-800 text-white py-3 px-6 rounded-full shadow-lg hover:bg-gray-900 transition duration-200",children:"Back to Management"})]})};function Ve(){return e.jsx(BrowserRouter,{basename:"/xitebtest",children:e.jsx(ee,{children:e.jsx(Se,{children:e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsxs(Ce,{children:[e.jsx(D,{path:"/",element:e.jsx(Ae,{})}),e.jsx(D,{path:"/login",element:e.jsx($e,{})}),e.jsx(D,{path:"/Register",element:e.jsx(Re,{})}),e.jsx(D,{path:"/prescriptions/:id/summary",element:e.jsx(ze,{})}),e.jsx(D,{path:"/admin-all-orders",element:e.jsx(_e,{})}),e.jsx(D,{path:"/order-management-admin",element:e.jsx(Ee,{})}),e.jsx(D,{path:"/admin/orders/:id",element:e.jsx(V,{})}),e.jsx(D,{path:"/admin/orders/:id",element:e.jsx(V,{})}),e.jsx(D,{path:"/drugs",element:e.jsx(Oe,{})}),e.jsx(D,{path:"/admin-dashboard",element:e.jsx(E,{children:e.jsx(Pe,{})})}),e.jsx(D,{path:"/admin/prescriptions/:id/quotation",element:e.jsx(Le,{})}),"            ",e.jsx(D,{path:"/user-dashboard",element:e.jsx(E,{children:e.jsx(Ie,{})})}),e.jsx(D,{path:"/order-management",element:e.jsx(E,{children:e.jsx(qe,{})})}),e.jsx(D,{path:"/orders-now",element:e.jsx(E,{children:e.jsx(Me,{})})}),e.jsx(D,{path:"/view-orders",element:e.jsx(E,{children:e.jsx(Te,{})})})]}),e.jsx(ke,{})]})})})})}De.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(ee,{children:e.jsx(Ve,{})})}));
